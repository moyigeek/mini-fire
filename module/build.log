make -C /lib/modules/5.15.0-119-generic/build M=/home/moyi/ws/module modules
make[1]: Entering directory '/usr/src/linux-headers-5.15.0-119-generic'
  CC [M]  /home/moyi/ws/module/stateful_check.o
In file included from /home/moyi/ws/module/stateful_check.h:9,
                 from /home/moyi/ws/module/stateful_check.c:1:
/home/moyi/ws/module/stateful_check.c: In function ‘stateful_firewall_check’:
/home/moyi/ws/module/stateful_check.c:102:32: error: passing argument 1 of ‘hlist_add_head’ from incompatible pointer type [-Werror=incompatible-pointer-types]
  102 |     hash_add(connection_table, &conn->list, hash_key);
      |                                ^~~~~~~~~~~
      |                                |
      |                                struct list_head *
./include/linux/hashtable.h:61:24: note: in definition of macro ‘hash_add’
   61 |         hlist_add_head(node, &hashtable[hash_min(key, HASH_BITS(hashtable))])
      |                        ^~~~
In file included from /home/moyi/ws/module/stateful_check.h:5,
                 from /home/moyi/ws/module/stateful_check.c:1:
./include/linux/list.h:897:54: note: expected ‘struct hlist_node *’ but argument is of type ‘struct list_head *’
  897 | static inline void hlist_add_head(struct hlist_node *n, struct hlist_head *h)
      |                                   ~~~~~~~~~~~~~~~~~~~^
/home/moyi/ws/module/stateful_check.c: In function ‘timeout_check’:
./include/linux/list.h:1043:26: error: assignment to ‘struct hlist_node *’ from incompatible pointer type ‘struct list_head *’ [-Werror=incompatible-pointer-types]
 1043 |              pos && ({ n = pos->member.next; 1; });                     \
      |                          ^
./include/linux/hashtable.h:155:17: note: in expansion of macro ‘hlist_for_each_entry_safe’
  155 |                 hlist_for_each_entry_safe(obj, tmp, &name[bkt], member)
      |                 ^~~~~~~~~~~~~~~~~~~~~~~~~
/home/moyi/ws/module/stateful_check.c:123:5: note: in expansion of macro ‘hash_for_each_safe’
  123 |     hash_for_each_safe(connection_table, bkt, tmp, conn, list) {
      |     ^~~~~~~~~~~~~~~~~~
In file included from ./include/linux/bitops.h:7,
                 from ./include/linux/kernel.h:12,
                 from ./include/linux/list.h:9,
                 from /home/moyi/ws/module/stateful_check.h:5,
                 from /home/moyi/ws/module/stateful_check.c:1:
./include/linux/typecheck.h:12:25: warning: comparison of distinct pointer types lacks a cast
   12 |         (void)(&__dummy == &__dummy2); \
      |                         ^~
./include/linux/jiffies.h:106:10: note: in expansion of macro ‘typecheck’
  106 |          typecheck(unsigned long, b) && \
      |          ^~~~~~~~~
/home/moyi/ws/module/stateful_check.c:124:13: note: in expansion of macro ‘time_after’
  124 |         if (time_after(now, conn->last_seen + TIMEOUT_INTERVAL)) {
      |             ^~~~~~~~~~
/home/moyi/ws/module/stateful_check.c:125:22: error: passing argument 1 of ‘hash_del’ from incompatible pointer type [-Werror=incompatible-pointer-types]
  125 |             hash_del(&conn->list);
      |                      ^~~~~~~~~~~
      |                      |
      |                      struct list_head *
In file included from /home/moyi/ws/module/stateful_check.h:9,
                 from /home/moyi/ws/module/stateful_check.c:1:
./include/linux/hashtable.h:105:48: note: expected ‘struct hlist_node *’ but argument is of type ‘struct list_head *’
  105 | static inline void hash_del(struct hlist_node *node)
      |                             ~~~~~~~~~~~~~~~~~~~^~~~
In file included from /home/moyi/ws/module/stateful_check.h:5,
                 from /home/moyi/ws/module/stateful_check.c:1:
/home/moyi/ws/module/stateful_check.c: In function ‘stateful_firewall_exit’:
./include/linux/list.h:1043:26: error: assignment to ‘struct hlist_node *’ from incompatible pointer type ‘struct list_head *’ [-Werror=incompatible-pointer-types]
 1043 |              pos && ({ n = pos->member.next; 1; });                     \
      |                          ^
./include/linux/hashtable.h:155:17: note: in expansion of macro ‘hlist_for_each_entry_safe’
  155 |                 hlist_for_each_entry_safe(obj, tmp, &name[bkt], member)
      |                 ^~~~~~~~~~~~~~~~~~~~~~~~~
/home/moyi/ws/module/stateful_check.c:160:5: note: in expansion of macro ‘hash_for_each_safe’
  160 |     hash_for_each_safe(connection_table, bkt, tmp, conn, list) {
      |     ^~~~~~~~~~~~~~~~~~
/home/moyi/ws/module/stateful_check.c:161:18: error: passing argument 1 of ‘hash_del’ from incompatible pointer type [-Werror=incompatible-pointer-types]
  161 |         hash_del(&conn->list);
      |                  ^~~~~~~~~~~
      |                  |
      |                  struct list_head *
In file included from /home/moyi/ws/module/stateful_check.h:9,
                 from /home/moyi/ws/module/stateful_check.c:1:
./include/linux/hashtable.h:105:48: note: expected ‘struct hlist_node *’ but argument is of type ‘struct list_head *’
  105 | static inline void hash_del(struct hlist_node *node)
      |                             ~~~~~~~~~~~~~~~~~~~^~~~
In file included from <command-line>:
/home/moyi/ws/module/stateful_check.c: In function ‘timeout_check’:
././include/linux/compiler_types.h:334:45: error: call to ‘__compiletime_assert_585’ declared with attribute error: pointer type mismatch in container_of()
  334 |         _compiletime_assert(condition, msg, __compiletime_assert_, __COUNTER__)
      |                                             ^
././include/linux/compiler_types.h:315:25: note: in definition of macro ‘__compiletime_assert’
  315 |                         prefix ## suffix();                             \
      |                         ^~~~~~
././include/linux/compiler_types.h:334:9: note: in expansion of macro ‘_compiletime_assert’
  334 |         _compiletime_assert(condition, msg, __compiletime_assert_, __COUNTER__)
      |         ^~~~~~~~~~~~~~~~~~~
./include/linux/build_bug.h:39:37: note: in expansion of macro ‘compiletime_assert’
   39 | #define BUILD_BUG_ON_MSG(cond, msg) compiletime_assert(!(cond), msg)
      |                                     ^~~~~~~~~~~~~~~~~~
./include/linux/kernel.h:495:9: note: in expansion of macro ‘BUILD_BUG_ON_MSG’
  495 |         BUILD_BUG_ON_MSG(!__same_type(*(ptr), ((type *)0)->member) &&   \
      |         ^~~~~~~~~~~~~~~~
./include/linux/list.h:990:40: note: in expansion of macro ‘container_of’
  990 | #define hlist_entry(ptr, type, member) container_of(ptr,type,member)
      |                                        ^~~~~~~~~~~~
./include/linux/list.h:1001:22: note: in expansion of macro ‘hlist_entry’
 1001 |            ____ptr ? hlist_entry(____ptr, type, member) : NULL; \
      |                      ^~~~~~~~~~~
./include/linux/list.h:1042:20: note: in expansion of macro ‘hlist_entry_safe’
 1042 |         for (pos = hlist_entry_safe((head)->first, typeof(*pos), member);\
      |                    ^~~~~~~~~~~~~~~~
./include/linux/hashtable.h:155:17: note: in expansion of macro ‘hlist_for_each_entry_safe’
  155 |                 hlist_for_each_entry_safe(obj, tmp, &name[bkt], member)
      |                 ^~~~~~~~~~~~~~~~~~~~~~~~~
/home/moyi/ws/module/stateful_check.c:123:5: note: in expansion of macro ‘hash_for_each_safe’
  123 |     hash_for_each_safe(connection_table, bkt, tmp, conn, list) {
      |     ^~~~~~~~~~~~~~~~~~
././include/linux/compiler_types.h:334:45: error: call to ‘__compiletime_assert_586’ declared with attribute error: pointer type mismatch in container_of()
  334 |         _compiletime_assert(condition, msg, __compiletime_assert_, __COUNTER__)
      |                                             ^
././include/linux/compiler_types.h:315:25: note: in definition of macro ‘__compiletime_assert’
  315 |                         prefix ## suffix();                             \
      |                         ^~~~~~
././include/linux/compiler_types.h:334:9: note: in expansion of macro ‘_compiletime_assert’
  334 |         _compiletime_assert(condition, msg, __compiletime_assert_, __COUNTER__)
      |         ^~~~~~~~~~~~~~~~~~~
./include/linux/build_bug.h:39:37: note: in expansion of macro ‘compiletime_assert’
   39 | #define BUILD_BUG_ON_MSG(cond, msg) compiletime_assert(!(cond), msg)
      |                                     ^~~~~~~~~~~~~~~~~~
./include/linux/kernel.h:495:9: note: in expansion of macro ‘BUILD_BUG_ON_MSG’
  495 |         BUILD_BUG_ON_MSG(!__same_type(*(ptr), ((type *)0)->member) &&   \
      |         ^~~~~~~~~~~~~~~~
./include/linux/list.h:990:40: note: in expansion of macro ‘container_of’
  990 | #define hlist_entry(ptr, type, member) container_of(ptr,type,member)
      |                                        ^~~~~~~~~~~~
./include/linux/list.h:1001:22: note: in expansion of macro ‘hlist_entry’
 1001 |            ____ptr ? hlist_entry(____ptr, type, member) : NULL; \
      |                      ^~~~~~~~~~~
./include/linux/list.h:1044:20: note: in expansion of macro ‘hlist_entry_safe’
 1044 |              pos = hlist_entry_safe(n, typeof(*pos), member))
      |                    ^~~~~~~~~~~~~~~~
./include/linux/hashtable.h:155:17: note: in expansion of macro ‘hlist_for_each_entry_safe’
  155 |                 hlist_for_each_entry_safe(obj, tmp, &name[bkt], member)
      |                 ^~~~~~~~~~~~~~~~~~~~~~~~~
/home/moyi/ws/module/stateful_check.c:123:5: note: in expansion of macro ‘hash_for_each_safe’
  123 |     hash_for_each_safe(connection_table, bkt, tmp, conn, list) {
      |     ^~~~~~~~~~~~~~~~~~
/home/moyi/ws/module/stateful_check.c: In function ‘stateful_firewall_check’:
././include/linux/compiler_types.h:334:45: error: call to ‘__compiletime_assert_583’ declared with attribute error: pointer type mismatch in container_of()
  334 |         _compiletime_assert(condition, msg, __compiletime_assert_, __COUNTER__)
      |                                             ^
././include/linux/compiler_types.h:315:25: note: in definition of macro ‘__compiletime_assert’
  315 |                         prefix ## suffix();                             \
      |                         ^~~~~~
././include/linux/compiler_types.h:334:9: note: in expansion of macro ‘_compiletime_assert’
  334 |         _compiletime_assert(condition, msg, __compiletime_assert_, __COUNTER__)
      |         ^~~~~~~~~~~~~~~~~~~
./include/linux/build_bug.h:39:37: note: in expansion of macro ‘compiletime_assert’
   39 | #define BUILD_BUG_ON_MSG(cond, msg) compiletime_assert(!(cond), msg)
      |                                     ^~~~~~~~~~~~~~~~~~
./include/linux/kernel.h:495:9: note: in expansion of macro ‘BUILD_BUG_ON_MSG’
  495 |         BUILD_BUG_ON_MSG(!__same_type(*(ptr), ((type *)0)->member) &&   \
      |         ^~~~~~~~~~~~~~~~
./include/linux/list.h:990:40: note: in expansion of macro ‘container_of’
  990 | #define hlist_entry(ptr, type, member) container_of(ptr,type,member)
      |                                        ^~~~~~~~~~~~
./include/linux/list.h:1001:22: note: in expansion of macro ‘hlist_entry’
 1001 |            ____ptr ? hlist_entry(____ptr, type, member) : NULL; \
      |                      ^~~~~~~~~~~
./include/linux/list.h:1011:20: note: in expansion of macro ‘hlist_entry_safe’
 1011 |         for (pos = hlist_entry_safe((head)->first, typeof(*(pos)), member);\
      |                    ^~~~~~~~~~~~~~~~
./include/linux/hashtable.h:166:9: note: in expansion of macro ‘hlist_for_each_entry’
  166 |         hlist_for_each_entry(obj, &name[hash_min(key, HASH_BITS(name))], member)
      |         ^~~~~~~~~~~~~~~~~~~~
/home/moyi/ws/module/stateful_check.c:74:5: note: in expansion of macro ‘hash_for_each_possible’
   74 |     hash_for_each_possible(connection_table, conn, list, hash_key) {
      |     ^~~~~~~~~~~~~~~~~~~~~~
/home/moyi/ws/module/stateful_check.c: In function ‘stateful_firewall_exit’:
././include/linux/compiler_types.h:334:45: error: call to ‘__compiletime_assert_587’ declared with attribute error: pointer type mismatch in container_of()
  334 |         _compiletime_assert(condition, msg, __compiletime_assert_, __COUNTER__)
      |                                             ^
././include/linux/compiler_types.h:315:25: note: in definition of macro ‘__compiletime_assert’
  315 |                         prefix ## suffix();                             \
      |                         ^~~~~~
././include/linux/compiler_types.h:334:9: note: in expansion of macro ‘_compiletime_assert’
  334 |         _compiletime_assert(condition, msg, __compiletime_assert_, __COUNTER__)
      |         ^~~~~~~~~~~~~~~~~~~
./include/linux/build_bug.h:39:37: note: in expansion of macro ‘compiletime_assert’
   39 | #define BUILD_BUG_ON_MSG(cond, msg) compiletime_assert(!(cond), msg)
      |                                     ^~~~~~~~~~~~~~~~~~
./include/linux/kernel.h:495:9: note: in expansion of macro ‘BUILD_BUG_ON_MSG’
  495 |         BUILD_BUG_ON_MSG(!__same_type(*(ptr), ((type *)0)->member) &&   \
      |         ^~~~~~~~~~~~~~~~
./include/linux/list.h:990:40: note: in expansion of macro ‘container_of’
  990 | #define hlist_entry(ptr, type, member) container_of(ptr,type,member)
      |                                        ^~~~~~~~~~~~
./include/linux/list.h:1001:22: note: in expansion of macro ‘hlist_entry’
 1001 |            ____ptr ? hlist_entry(____ptr, type, member) : NULL; \
      |                      ^~~~~~~~~~~
./include/linux/list.h:1042:20: note: in expansion of macro ‘hlist_entry_safe’
 1042 |         for (pos = hlist_entry_safe((head)->first, typeof(*pos), member);\
      |                    ^~~~~~~~~~~~~~~~
./include/linux/hashtable.h:155:17: note: in expansion of macro ‘hlist_for_each_entry_safe’
  155 |                 hlist_for_each_entry_safe(obj, tmp, &name[bkt], member)
      |                 ^~~~~~~~~~~~~~~~~~~~~~~~~
/home/moyi/ws/module/stateful_check.c:160:5: note: in expansion of macro ‘hash_for_each_safe’
  160 |     hash_for_each_safe(connection_table, bkt, tmp, conn, list) {
      |     ^~~~~~~~~~~~~~~~~~
././include/linux/compiler_types.h:334:45: error: call to ‘__compiletime_assert_588’ declared with attribute error: pointer type mismatch in container_of()
  334 |         _compiletime_assert(condition, msg, __compiletime_assert_, __COUNTER__)
      |                                             ^
././include/linux/compiler_types.h:315:25: note: in definition of macro ‘__compiletime_assert’
  315 |                         prefix ## suffix();                             \
      |                         ^~~~~~
././include/linux/compiler_types.h:334:9: note: in expansion of macro ‘_compiletime_assert’
  334 |         _compiletime_assert(condition, msg, __compiletime_assert_, __COUNTER__)
      |         ^~~~~~~~~~~~~~~~~~~
./include/linux/build_bug.h:39:37: note: in expansion of macro ‘compiletime_assert’
   39 | #define BUILD_BUG_ON_MSG(cond, msg) compiletime_assert(!(cond), msg)
      |                                     ^~~~~~~~~~~~~~~~~~
./include/linux/kernel.h:495:9: note: in expansion of macro ‘BUILD_BUG_ON_MSG’
  495 |         BUILD_BUG_ON_MSG(!__same_type(*(ptr), ((type *)0)->member) &&   \
      |         ^~~~~~~~~~~~~~~~
./include/linux/list.h:990:40: note: in expansion of macro ‘container_of’
  990 | #define hlist_entry(ptr, type, member) container_of(ptr,type,member)
      |                                        ^~~~~~~~~~~~
./include/linux/list.h:1001:22: note: in expansion of macro ‘hlist_entry’
 1001 |            ____ptr ? hlist_entry(____ptr, type, member) : NULL; \
      |                      ^~~~~~~~~~~
./include/linux/list.h:1044:20: note: in expansion of macro ‘hlist_entry_safe’
 1044 |              pos = hlist_entry_safe(n, typeof(*pos), member))
      |                    ^~~~~~~~~~~~~~~~
./include/linux/hashtable.h:155:17: note: in expansion of macro ‘hlist_for_each_entry_safe’
  155 |                 hlist_for_each_entry_safe(obj, tmp, &name[bkt], member)
      |                 ^~~~~~~~~~~~~~~~~~~~~~~~~
/home/moyi/ws/module/stateful_check.c:160:5: note: in expansion of macro ‘hash_for_each_safe’
  160 |     hash_for_each_safe(connection_table, bkt, tmp, conn, list) {
      |     ^~~~~~~~~~~~~~~~~~
cc1: some warnings being treated as errors
make[2]: *** [scripts/Makefile.build:297: /home/moyi/ws/module/stateful_check.o] Error 1
make[1]: *** [Makefile:1911: /home/moyi/ws/module] Error 2
make[1]: Leaving directory '/usr/src/linux-headers-5.15.0-119-generic'
make: *** [Makefile:10: all] Error 2
